#!/bin/sh
#
# List all EXXXX macros
#

set -e 

: ${CC:=cc}

PATH="$(dirname $0):${PATH}"

TMPFILE=".$(basename $0).c"
trap "rm -f ${TMPFILE}" EXIT

filter() {
	awk '$1~/^#define/ && $2~/^E/{ print $2 }'
}

vendor() {
	case "$(vendor.cc)" in
		*sunpro*)
			echo "#include <errno.h>" >| ${TMPFILE}
			${CC} -xM ${TMPFILE} | awk '/\.h$/{ print $2 }' | sort -u | xargs cat | filter
			rm ${TMPFILE}
			;;
		*)
			echo "#include <errno.h>" | ${CC} -dM -E - | filter
			;;
	esac
}

posix() {
	cat <<-EOF | tr " " "\n"
		E2BIG EACCES EADDRINUSE EADDRNOTAVAIL EAFNOSUPPORT EAGAIN
		EWOULDBLOCK EALREADY EBADF EBADMSG EBUSY ECANCELED ECHILD
		ECONNABORTED ECONNREFUSED ECONNRESET EDEADLK EDESTADDRREQ
		EDOM EDQUOT EEXIST EFAULT EFBIG EHOSTUNREACH EIDRM EILSEQ
		EINPROGRESS EINTR EINVAL EIO EISCONN EISDIR ELOOP EMFILE
		EMLINK EMSGSIZE EMULTIHOP ENAMETOOLONG ENETDOWN ENETRESET
		ENETUNREACH ENFILE ENOBUFS ENODATA ENODEV ENOENT ENOEXEC
		ENOLCK ENOLINK ENOMEM ENOMSG ENOPROTOOPT ENOSPC ENOSR ENOSTR
		ENOSYS ENOTCONN ENOTDIR ENOTEMPTY ENOTRECOVERABLE ENOTSOCK
		ENOTSUP EOPNOTSUPP ENOTTY ENXIO EOPNOTSUPP ENOTSUP EOVERFLOW
		EOWNERDEAD EPERM EPIPE EPROTO EPROTONOSUPPORT EPROTOTYPE
		ERANGE EROFS ESPIPE ESRCH ESTALE ETIME ETIMEDOUT ETXTBSY
		EWOULDBLOCK EAGAIN EXDEV
	EOF
}

(posix; vendor) | sort -u

