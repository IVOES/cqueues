#!/bin/sh
#
# List all EXXXX macros
#

set -e 

: ${CC:=cc}

PATH="$(dirname $0):${PATH}"

TMPFILE=".$(basename $0).c"
trap "rm -f ${TMPFILE}" EXIT

filter() {
	awk '$1~/^#define/ && $2~/^E/{ print $2 }' | sort -u
}

case "$(vendor.cc)" in
	*sunpro*)
		echo "#include <errno.h>" >| ${TMPFILE}
		${CC} -xM ${TMPFILE} | awk '/\.h$/{ print $2 }' | sort -u | xargs cat | filter
		rm ${TMPFILE}
		;;
	*)
		echo "#include <errno.h>" | ${CC} -dM -E - | filter
		;;
esac
